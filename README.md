# WaveLabX

WaveLabX is an open-source Python toolkit for experimental wave-probe analysis. It provides
utilities and algorithms commonly used in laboratory wave flume analysis, including

- One-probe zero-crossing wave statistics
- Two-probe Goda/Suzuki reflection analysis
- Three-probe array decomposition for incident/reflected separation

This repository contains the package source (`wavelabx/`), an illustrative example notebook
(`run_wavelabx_example.ipynb`), sample data (`wavedata.csv`), and example figures used in the
manuscript.

## Contents

- `wavelabx/` — package source (public API: `compute_wavelength`, `zero_crossing`, `two_probe_goda`, `three_probe_array`)
- `run_wavelabx_example.ipynb` — runnable example that reproduces the figures and demonstrates usage
- `wavedata.csv` — example probe time-series used by the notebook
- example PNG figures (generated by the notebook for the manuscript)
- `README.md`, `LICENSE` (MIT), `.gitignore`

## Installation

Recommended: create and use a Python virtual environment (venv or conda).

1. Create and activate a venv (example using Python3 venv):

```bash
python3 -m venv .venv
source .venv/bin/activate   # zsh/bash
```

2. Install required packages. Minimal requirements for the example are NumPy, SciPy, pandas and Matplotlib.
You can install with pip:

```bash
pip install --upgrade pip
pip install numpy scipy pandas matplotlib
```

3. (Optional) Install the package in editable/development mode to import it from the repo root:

```bash
pip install -e .
```

Note: this repository does not include a full `pyproject.toml` or `requirements.txt`; add one if you
need pinned dependency versions for CI or reproducibility.

## Quick start — run the example notebook

1. Launch Jupyter or open `run_wavelabx_example.ipynb` in VS Code and run the cells. The notebook runs
   the following workflow:

   - Load `wavedata.csv` (three probes)
   - Compute one-probe zero-crossing statistics for Probe 1
   - Run two-probe Goda reflection analysis on Probes 2 & 3
   - Run the three-probe array decomposition using Probes 1, 2 & 3
   - Generate and save the manuscript figures (if plotting is enabled)

2. The notebook exposes the driver function `run_wavelabx_example(csv_path, fs, h, gpos, show_plots)`.

Example (script-style run using the included optional script if present):

```bash
python3 run_wavelabx_example.py --csv wavedata.csv --fs 100.0 --h 0.25
```

Add `--show-plots` to enable plotting when running the script (plots are disabled by default to make
the example safe to run in headless CI environments).

## Disabling plotting / headless operation

The notebook and package are designed so plotting is optional:

- The driver `run_wavelabx_example(..., show_plots=False)` will not call plotting functions unless
  `show_plots=True`.
- Many internal functions accept a `plot` kwarg (e.g. `two_probe_goda(..., plot=False)`) which prevents
  figure creation.
- For environments without a display set Matplotlib to a non-interactive backend before importing `pyplot`:

```python
import matplotlib
matplotlib.use("Agg")  # only if you need to run without a display
```

## Package API (brief)

The public API lives in the `wavelabx` package. Key functions:

- `compute_wavelength(h, T)` — solve linear dispersion relation and return wavelength L for depth `h` and period `T`.
- `zero_crossing(eta, fs)` — compute zero-crossing wave statistics for a single probe time series; returns a stats dict and name list.
- `two_probe_goda(eta12, fs, h, gpos, plot=False)` — two-probe Goda/Suzuki spectral reflection analysis. `eta12` is an (N,2) array.
- `three_probe_array(eta123, fs, h, gpos, plot=True)` — three-probe array decomposition for incident/reflected components. `eta123` is an (N,3) array.

See the function docstrings inside `wavelabx/*.py` for detailed parameter descriptions, return values, and implementation notes.

## Reproducing manuscript figures

1. Run the example notebook or the script with `--show-plots` enabled.
2. The notebook will save publication-ready PNG figures to the repo root (names such as `threeprobe_spectra.png`, `twoprobe_spectra.png`, `validation_synthetic.png`, `wavelabx_timeseries.png`).
3. For vector output, you can enable PDF saving in the plotting sections (commented out in the notebook); to do this, open the relevant cell and uncomment the `fig.savefig(..., pdf)` lines.

## Data and reproducibility

The example data file `wavedata.csv` is included for demonstration. It contains three columns representing synchronized free-surface measurements for three probes. For reproducible published results:

- State the sampling frequency `fs` and water depth `h` used in the analysis.
- Use the driver function with deterministic parameters (don't change random seeds or windowing settings unless explicitly stated).

If you plan to publish results derived from this code, please include the exact commit hash of the repository and the versions of the main dependencies (NumPy, SciPy, pandas, Matplotlib).

## Citation

If you use WaveLabX in published research, please cite the software and the accompanying manuscript (SoftwareX submission). A suggested BibTeX entry:

```bibtex
@software{WaveLabX_2025,
  author = {S. Lamsal},
  title = {WaveLabX: A Python toolkit for wave-probe analysis},
  year = {2025},
  url = {https://github.com/sandslamsal/WaveLabX},
}
```

Replace authors/titles/DOI with the final published reference when available.

## License

This repository is released under the MIT License — see the `LICENSE` file for details.

## Contributing

Contributions are welcome. Please follow these steps:

1. Fork the repository and create a feature branch: `git checkout -b feature/your-feature`.
2. Add tests where appropriate and keep changes focused and documented.
3. Open a pull request describing your change and how it was tested.

Before contributing code, please open an issue to discuss large changes or design decisions.

## CI / Tests (recommended)

For publication, I recommend adding a minimal GitHub Actions workflow that:

- Creates a Python environment (3.10/3.11),
- Installs minimal dependencies (numpy, scipy, pandas, matplotlib),
- Runs a smoke test: `python -c "import wavelabx; print(wavelabx.__all__)"`, and
- Runs the example in non-plotting/headless mode to ensure the notebook/script runs without display.

If you want, I can add such a workflow to `.github/workflows/ci.yml`.

## Contact and support

For questions, bug reports, or collaboration inquiries open an issue on GitHub or contact the maintainer:

- GitHub: https://github.com/sandslamsal
- Email: slamsal60@gmail.com

## Acknowledgements

Development was supported by the WaveLabX authors and reviewers. Please include acknowledgements in your
manuscript if you use this code directly for published figures.

